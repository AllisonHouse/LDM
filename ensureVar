LDMHOME=${1?LDM home directory not set}

cd $LDMHOME || exit 1

# If "data" is a symbolic link to a directory then "test -d data" is true but
# "test -d data a- ! -h data" is false.
#
if test -d data -a ! -h data; then
    # "data" is a directory and not a symbolic link -- probably from an
    # older LDM installation. Symbolically link to it.
    test -e var/data || (cd var && ln -s ../data data)
    test -e var/queues || (cd var && ln -s ../data queues)
else
    # "data" doesn't exist or is a symbolic link
    test -e var/queues || mkdir -p var/queues
    test -e var/data || mkdir -p var/data
    if test -h data; then
        # "data" is a symbolic link
        rm -f data
        ln -s var/data data
    fi
fi

if test -d logs -a ! -h logs; then
    # "logs" is a directory and not a symbolic link -- probably from an
    # older LDM installation
    test -e var/logs || (cd var && ln -s ../logs logs)
else
    test -e var/logs || mkdir -p var/logs
    if test -h logs; then
        # "logs" is a symbolic link
        rm -f logs
        ln -s var/logs logs
    fi
fi
