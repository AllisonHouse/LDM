LDMHOME=${1?LDM home directory not set}

cd $LDMHOME || exit 1

# If "data" is a symbolic link to a directory then "test -d data" is true but
# "test -d data a- ! -h data" is false.
#
if test -d data -a ! -h data; then
    # "$HOME/data" is a directory and not a symbolic link -- probably from an
    # older LDM installation. Symbolically link to it.
    test -e var/data || (cd var && ln -s ../data data)
    test -e var/queues || (cd var && ln -s ../data queues)
else
    # "$HOME/data" doesn't exist or is a symbolic link
    test -e var/queues || mkdir -p var/queues
    test -e var/data || mkdir -p var/data
    rm -f data # obsolete
fi

if test -d logs -a ! -h logs; then
    # "$HOME/logs" is a directory and not a symbolic link -- probably from an
    # older LDM installation
    test -e var/logs || (cd var && ln -s ../logs logs)
else
    test -e var/logs || mkdir -p var/logs
    rm -f logs # obsolete
fi
